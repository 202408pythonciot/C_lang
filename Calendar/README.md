# カレンダー
## グレゴリオ暦
紀元前46年から用いられていたユリウス暦では，平年は1年を365日とし，4年ごとに置くうるう年を366日としていた。しかし，実際の地球の公転より1年で約0.0078日（約11分15秒）長いため，約128年で1日になる。この誤差を調整するためローマ教皇グレゴリウス13世がユリウス暦の改良を命じ1582年10月15日（金）から使われた暦である。なお1582年10月15日（金）の前日は1582年10月4日（木）である。

グレゴリオ暦でのうるう年の計算方法は

* 4で割り切れるが100で割り切れない年，および400で割り切れる年はうるう年（366日）
* それ以外の年は平年（365日）

```C
// グレゴリオ暦の年をいれるとうるう年であれば「1」を，それ以外は「0」を返す関数
int check_leap_year(int year){
    if (year % 400 == 0 || (year % 4 == 0 && year % 100 != 0)){
        return 1;
    }
    return 0;
}
```

## グレゴリオ暦での曜日判定
グレゴリオ暦 $`Y`$ 年 $`M`$ 月 $`D`$ 日の曜日を「日：0，月：1，〜，土：6」で表す方法を考える。うるう年は，2月29日があるため，2月の末日を最後に持ってくる（1月と2月を前年のそれぞれ13月と14月として扱う）。

* $`Y`$ 年の前年である$`(Y - 1)`$ 年までに経過した日数は，$`365(Y - 1)`$日
* うるう年による日数の変化が $`Y / 4 - Y / 100 + Y / 400`$日
* $`Y`$ 年に入ってから$` (M - 1)`$月までの日数が $`31 + 28 + 306(M + 1)/10 - 122`$
* $`M`$ 月に入ってから経過した日数が $`D`$ 日

以上を整理すると，
```math
365(Y - 1) + \frac{Y}{4} - \frac{Y}{100} + \frac{Y}{400} + 31 + 28 + \frac{306(M + 1)}{10} - 122 + D
```

```math
365Y + \frac{Y}{4} - \frac{Y}{100} + \frac{Y}{400}  + \frac{306(M + 1)}{10} + D - 428 
```
となる。曜日計算はこの式の7の剰余を求めればよい。
```math
(365(Y - 1) +  + \frac{Y}{4} - \frac{Y}{100} + \frac{Y}{400}  + \frac{306(M + 1)}{10} + D - 428 ) \mod 7
```
日曜日が$`0`$になるように補正すると。


```math
wday = (y + \frac{y}{4} - \frac{y}{100} + \frac{y}{400} + \frac{13m + 8}{5} + d) \mod 7
```

これをツェラーの公式（Zeller's congruence）という。

```C
// グレゴリオ暦での曜日判定(日：0，月：1，〜，土：6)
int get_weekday(int year, int month, int day){
    if(month < 3){
        year  = year - 1;
        month = month + 12;
    }
    return (year + year / 4 - year / 100 + year / 400 + (13 * month + 8) / 5 + day) % 7;
}
```

## Julian Date（ジュリアン・デート）
1月1日を「1」として1日ごとに数を足していき，12月31日を「365」と数える日計算。IBMは，その年の1月1日から数えて何日目という経過日数と，12月31日までの残り日数を記入したスケジュール帳を配布している，
